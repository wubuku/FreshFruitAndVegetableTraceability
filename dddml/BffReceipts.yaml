valueObjects:
  BffReceivingDocumentDto:
    properties:
      DocumentId:
        type: id
      StatusId:
        type: id
      PartyIdTo:
        type: id
      PartyIdFrom:
        type: id
      OriginFacilityId:
        type: id
      DestinationFacilityId:
        type: id
      PrimaryOrderId:
        type: id
      PrimaryReturnId:
        type: id
      PrimaryShipGroupSeqId:
        type: id
      ReceivingItems:
        itemType: BffReceivingItemDto
        isList: true

  BffReceivingItemDto:
    properties:
      ReceiptId: #收货行项 Id
        type: id
      ProductId: #ItemId
        type: id
      # AttributeSetInstanceId:
      #   type: HashHex
      LotId:
        type: id
      LocationSeqId:
        type: id
      ItemDescription:
        type: description
      QuantityAccepted:
        type: fixed-point
      QuantityRejected:
        type: fixed-point
      # CaseUomId:
      #   type: id
      CasesAccepted:
        description: The number of cases accepted
        type: numeric
      CasesRejected:
        description: The number of cases rejected
        type: numeric
      OrderId:
        type: id
      OrderItemSeqId:
        type: id
      ReturnId:
        type: id
      ReturnItemSeqId:
        type: id
      RejectionId:
        type: id
      ShipmentId:
        type: id
      ShipmentItemSeqId:
        type: id
      ShipmentPackageSeqId:
        type: id

services:
  BffReceivingService:
    restfulResourceName: BffReceipts
    methods:
      GetReceivingDocuments:
        metadata:
          IsPageable: true
          ReturnPageEnvelope: true
        isQuery: true
        result:
          itemType: BffReceivingDocumentDto

      GetReceivingDocument:
        # 获取指定收货单详情
        restfulResourceName: "{DocumentId}"
        metadata:
          RestfulPathVariable: DocumentId
        isQuery: true
        result:
          type: BffReceivingDocumentDto
        parameters:
          DocumentId:
            type: id

      GetReceivingItem:
        # 获取指定收货单下指定行项的详情
        restfulResourceName: "{DocumentId}/Items/{ReceiptId}"
        metadata:
          RestfulPathVariables:
            - DocumentId
            - ReceiptId
        isQuery: true
        result:
          type: BffReceivingItemDto
        parameters:
          DocumentId:
            type: id
          ReceiptId:
            type: id

      CreateReceivingDocument:
        # 创建收货单
        httpMethod: POST
        metadata:
          HttpRequestBody: ReceivingDocument
        parameters:
          ReceivingDocument:
            type: BffReceivingDocumentDto
          # 在创建收货单时指定当前仓库（DestinationFacilityId）？
          # ReceivingItems:
          #   # 一般这里只要有一个行项，即在添加第一个行项的时候生成收货单。
          #   # 行项中包含了 PO 的 Id（OrderId）。传入第一个行项的 PO 的 Id 作为收货单的 PrimaryOrderId。
          #   itemType: BffReceivingItemDto

      UpdateReceivingDocumentPrimaryOrderId:
        # 给收货时未填写 PO 单号的收货单补充 PO 单号。
        httpMethod: PUT
        restfulResourceName: "{DocumentId}/PrimaryOrderId"
        metadata:
          RestfulPathVariable: DocumentId
          HttpRequestBody: PrimaryOrderId
        parameters:
          DocumentId:
            type: id
          PrimaryOrderId:
            type: id


      CreateReceivingItem:
        # 添加行项的方法
        httpMethod: POST
        restfulResourceName: "{DocumentId}/Items"
        metadata:
          RestfulPathVariables:
            - DocumentId
          HttpRequestBody: ReceivingItem
        parameters:
          DocumentId:
            type: id
          ReceivingItem:
            type: BffReceivingItemDto

      DeleteReceivingItem:
        # 删除行项的方法
        httpMethod: DELETE
        restfulResourceName: "{DocumentId}/Items/{ReceiptId}"
        metadata:
          RestfulPathVariables:
            - DocumentId
            - ReceiptId
        parameters:
          DocumentId:
            type: id
          ReceivingItem:
            type: BffReceivingItemDto

      UpdateReceivingItem:
        # 更新行项的方法
        httpMethod: PUT
        restfulResourceName: "{DocumentId}/Items/{ReceiptId}"
        metadata:
          RestfulPathVariables:
            - DocumentId
            - ReceiptId
        parameters:
          DocumentId:
            type: id
          ReceiptId:
            type: id
          DestinationFacilityId:
            # 只有当收货单的只存在一个行项（当前行项）时，才允许修改 DestinationFacilityId？
            type: id
          LotId:
            type: id
          LocationSeqId:
            type: id
            # 更新行项的货位（Location）
          ItemDescription:
            type: description
          QuantityAccepted:
            type: fixed-point
          QuantityRejected:
            type: fixed-point
          # CaseUomId:
          #   type: id
          CasesAccepted:
            description: The number of cases accepted
            type: numeric
          CasesRejected:
            description: The number of cases rejected
            type: numeric
